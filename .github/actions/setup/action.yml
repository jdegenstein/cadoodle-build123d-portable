name: 'Setup'
inputs:
  python-version:  # id of input
    description: 'Python version'
    required: true

env:
  UV_INSTALL_DIR: "${GITHUB_WORKSPACE}/uv"

runs:
  using: "composite"
  steps:
    - name: Install uv into local working directory
      shell: bash
      run: |
        mkdir uv
        curl -LsSf https://astral.sh/uv/install.sh | env UV_UNMANAGED_INSTALL="${GITHUB_WORKSPACE}/uv" sh
        echo $PATH
        export PATH="${GITHUB_WORKSPACE}/uv:$PATH"
        echo $PATH
        chmod +x ${GITHUB_WORKSPACE}/uv/uv
        uv --version
        ls -alR
    # - name: Setup Python
    #   uses: astral-sh/setup-uv@v6
    #   with:
    #     enable-cache: false
        # python-version: ${{ inputs.python-version }}
        # activate-environment: true
    - name: Install Requirements
      shell: bash
      #TODO: re-test with input python version
      run: |
        mkdir python
        mkdir pyinst
        export UV_PYTHON_BIN_DIR="`pwd`/python"
        export UV_PYTHON_INSTALL_DIR="`pwd`/pyinst"
        echo $PATH
        export PATH="${GITHUB_WORKSPACE}/uv:$PATH"
        echo $PATH
        uv python install 3.12
        uv venv --relocatable --python 3.12
        uv pip install build123d
